# タスク名: 現在時間MCPサーバーの実装

要件定義書： `project/requirements/01-current-time-server-requirements.md`

## 概要

要件定義書に基づいて現在時間を返すMCPサーバーを実装する。
@modelcontextprotocol/sdkを使用してMCPプロトコルに準拠したサーバーを構築し、
指定されたタイムゾーンとフォーマットで現在時刻を返すgetCurrentTimeツールを提供する。

## To-Be(完了条件のチェックリスト)

- [x] `backlog`から`in-progress`へタスクを移動
- [x] デフォルト実行テスト（TC001）を実行して失敗することを確認
- [x] デフォルト実行テスト（TC001）を通す最小限のコードを書く
- [x] デフォルト実行テストが通っている状態を維持しながら、コードを改善(リファクタリング)
- [x] タイムゾーン指定テスト（TC002）を実行して失敗することを確認
- [x] タイムゾーン指定テスト（TC002）を通す最小限のコードを書く
- [x] タイムゾーン指定テストが通っている状態を維持しながら、コードを改善(リファクタリング)
- [x] フォーマット指定テスト（TC003）を実行して失敗することを確認
- [x] フォーマット指定テスト（TC003）を通す最小限のコードを書く
- [x] フォーマット指定テストが通っている状態を維持しながら、コードを改善(リファクタリング)
- [x] カスタムフォーマットテスト（TC004）を実行して失敗することを確認
- [x] カスタムフォーマットテスト（TC004）を通す最小限のコードを書く
- [x] カスタムフォーマットテストが通っている状態を維持しながら、コードを改善(リファクタリング)
- [x] 複合パラメータテスト（TC005）を実行して失敗することを確認
- [x] 複合パラメータテスト（TC005）を通す最小限のコードを書く
- [x] 複合パラメータテストが通っている状態を維持しながら、コードを改善(リファクタリング)
- [x] 無効タイムゾーンテスト（TC101）を実行して失敗することを確認
- [x] 無効タイムゾーンテスト（TC101）を通す最小限のコードを書く
- [x] 無効タイムゾーンエラーハンドリングを改善(リファクタリング)
- [x] 無効フォーマットテスト（TC102）を実行して失敗することを確認
- [x] 無効フォーマットテスト（TC102）を通す最小限のコードを書く
- [x] 無効フォーマットエラーハンドリングを改善(リファクタリング)
- [x] カスタムフォーマット未指定テスト（TC103）を実行して失敗することを確認
- [x] カスタムフォーマット未指定テスト（TC103）を通す最小限のコードを書く
- [x] カスタムフォーマット未指定処理を改善(リファクタリング)
- [x] 空パラメータテスト（TC104）を実行して失敗することを確認
- [x] 空パラメータテスト（TC104）を通す最小限のコードを書く
- [x] 空パラメータ処理を改善(リファクタリング)
- [x] テスト全てパス(`npm run test`で確認)
- [x] テストカバレッジが**100%**であることを確認（`npm run test:cov`で確認）
- [x] `mcp__ide__getDiagnostics`ツールを使用して言語診断で問題ないことを確認
- [x] MCPサーバーの起動確認とツールの動作テスト
- [x] ドキュメント更新
- [x] README更新
- [x] `in-progress`から`done`へタスクを移動

## 実装すべき機能

### getCurrentTimeツール
- 現在の日時を指定されたタイムゾーンとフォーマットで返す
- デフォルト：Asia/Tokyo、ISO 8601形式
- サポートタイムゾーン：UTC、JST、EST、PST、GMT、IANA形式
- サポートフォーマット：iso、rfc、custom

### エラーハンドリング
- 無効なタイムゾーン指定時のエラー
- 無効なフォーマット指定時のエラー
- 適切なエラーコードとメッセージの返却

### パフォーマンス要件
- レスポンス時間：100ms以内
- 同時処理：最大10リクエスト/秒

## 実装結果

### 主要コンポーネント
- **サーバー実装**: `src/features/server/server.ts`
- **テストファイル**: `src/features/server/tests/server.test.ts`
- **エントリーポイント**: `src/app/index.ts`

### 技術仕様
- TypeScript + @modelcontextprotocol/sdk
- zodによるスキーマバリデーション
- neverthrowによる関数型エラーハンドリング
- vitestによる包括的テスト（21のテストケース）
- 100%テストカバレッジ達成

### 実装機能
- getCurrentTimeツール
- 3つのフォーマット対応（ISO、RFC、カスタム）
- タイムゾーン検証とエラーハンドリング
- デバッグログ機能

## 作業ログ

- [2025-06-18 作成]：開発タスクを作成した
- [2025-06-18 移動]：backlogからin-progressへ移動開始
- [2025-06-18 実装]：getCurrentTimeツールの実装完了
- [2025-06-18 テスト]：全テストケース実装・カバレッジ100%達成
- [2025-06-18 完了]：MCPサーバー動作確認完了・doneへ移動